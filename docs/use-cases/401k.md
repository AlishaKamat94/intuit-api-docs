---
layout: default
title: 401k
nav_order: 2
parent: Use Cases
---

## 401k

Intuit Payroll is engaged in partnerships with 401(k) plan providers to offer 401(k) benefits to Small Business Owners. This will allow businesses to provide retirement benefits to their employees. This guide will help you understand the high level integration.

### Integration Steps

* Create and configure app on Inuit Developer portal: [pre-production](https://developer-stage.intuit.com/app/developer/homepage) (do this first) and [production](https://developer.intuit.com/app/developer/homepage)  (Note: Use existing app unless there is a strong need to switch to new app)
  * [get started](https://developer.intuit.com/app/developer/qbo/docs/get-started), [go live](https://developer.intuit.com/app/developer/qbo/docs/go-live)  
* Implement OpenId Connect
  * [OpenID Connect](https://developer.intuit.com/app/developer/qbo/docs/develop/authentication-and-authorization/openid-connect) integration - send scopes openId+email+profile (Additional scopes can be requested if needed).
  * Send claims in the request (claims={"id_token":{"realmId":null}}) - OpenIdConnect doesn’t return back QBO realm info, by passing the claims in the request Intuit will send back the realmid if user is logged in. 
  * Call [UserInfo endpoint](https://developer.intuit.com/app/developer/qbo/docs/develop/authentication-and-authorization/openid-connect#obtaining-user-profile-information) to obtain user profile information.
  * Call [Role API]() - UserInfo and RoleAPI can be called in parallel
* Make OAuth call by sending accounting+payroll scope
  * Send realm_id in the request (&realm_id=<realm id>) if available, this will suppress the company picker screen.

* Call Payroll APIs
  * Payroll GraphGL endpoints


### Use Cases

There are four major connection points into payroll for the third party 401(k) providers 

#### Company Setup

When first setting up a company with a new 401k provider, information about the company needs to be sent back to map the authorization to the information in their system. Here are the fields as they have described it.

* Company ID
* EIN
* Company Name
* Company Address (primary address -> formatted address)
* Admin Name (business owner or signing authority if needed)
* Admin Email

This information is particularly helpful because if the company owner decides to subscribe to a 401k provider through the QB App Store, then this information will be pre-filled for them. And if the 401k provider has been authorized they can pull an employee roster which will help their recommendation engine about what kind of plan to pick for everyone. 

After eestablishing connecton with QBO company run this  query for company details

```GRAPHQL

query company {
  company {
	id
	
	industryType
    
    taxIdentifiers {
      taxIdentifierType
      value
    }
    companyName
    companyType
    contactMethods {
      primary
      active
      address {
        streetAddress1
      }
      email
    }
  }
}
```

#### Employee roster

When setting up the plan, the 401k provider has access to the company's employee roster and their current status (active/not). Other endpoints will enhance this employee info such as the payslips for the year (being eligible for the plan requires 1000 hours worked in the US) and previous deduction elections if converting from another plan. 

* Employee ID
* First Name
* Last Name
* Employment Type
* Date of birth
* Hire Date
* Termination Date
* Compensations (Salar, bonus, etc)
* Email
* Physical Address (preferred to be in separate field, add 1, add 2, city, state, zip)
* Employee Status
* SSN 

SSN is the preferred way of mapping, but payroll ID can work as well up to a point. For legal reasons to be part of a plan, all employees participating in the plan must have SSN by the time of filing at the end of the year. Providers choose to do this differently:

* Some 401k providers chose to not enroll those employees that didn’t log in to select an election (and provide SSN)
* others will just fail due to auto-enroll preferences. 
* Some companies will enroll everyone and then near the end of the fiscal year (for us is always with calendar year QBO) just notify the owner of the plan of missing compliance data (SSN or Tax ID)

*Access to employee SSN and date of bith is not included by default, work with your Intuit partner to get the necessary scopes associated with your app.*

After eestablishing connecton with QBO company run this  query for employee roster

```GRAPHQL
query readEmployeeRoster {
  company {
		id
		
    industryType
    companyType
    employees{
      nodes {
        id
        firstName
        lastName
        displayName
        
        payrollProfile {
          preferredPhone
          preferredAddress {
            streetAddress1
            state
          }
          compensations {
            id
            active
            amount
          }
          deductions {
            id
            amount {
              percentage
              value
            }
          }
        }
      }
    }
  }
}
```

#### Contribution Level

401(k) Providers will have their own screens for sign up and enrollment of employees of the company, but will require that information be transferred back to QB Payroll so that the correct deductions can be taken. 
 
They will then need to write (and read) these fields for contribution per employee level. The only person who can edit the names or fields of each contribution will be the creator. If you are taking over from a different company as 401(K) provider work with QBO company's payroll admins to sunset contributions from previous plan. 

* Traditional % or Traditional $
* Roth % or Roth $
* loan amount $ 
* Loan ID
* Employer contribution %
* Employer contributions limit
* Nonelective contribution 
* Deduction Code

```
ADD MUTATOIN SAMPLE
```

#### Paycheck Information

401k providers need to download payslips after each payroll run so they know how much in deductions to take out for the employees, and this is where deductions details are most important.   At the beginning of the plan, providers will need to query for up to all of last fiscal year’s payslips to determine plan eligibility for each employee:

* Pay date
* Payroll Process Date (approved date)
* Employee ID
* SSN (again above entitlements)
* Paycheck ID
* Gross Pay
* YTD Pay (optional, not launch blocker)
* Payroll Type (optional - bonus, overtime, regular, etc)
* Hours Worked
* Amount deducted for each category (employee)
  * Roth
  * Traditional
  * Loan
* Employer contribution  

After eestablishing connecton with QBO company run this  query to download payslips periodically.

```GRAPHQL
query readAllEmployeePayslips {
  company {
	id
    employees{
      nodes {
        id
        }
        payslips {
            id
            payDate
            grossPay {
              amount
              yearToDateAmount
            }
            contributions {
              description
              contributionAmount {
                amount
                yearToDateAmount
              }
            }
            deductions {
              type
              description
              deductionAmount {
                amount
                yearToDateAmount
              }
            }
          }
      }
    }
  }
}
```
