---
layout: default
title: Error Handling
nav_order: 3
parent: FAQ
---

## Error Handling

All Ecosystem API requests made by developers pass through a Gateway and then reach the Ecosystem API Service layer.

Thus, errors for the Ecosystem API requests can be thrown from these two layers and can be essentially categorized into the following types:

-   Intuit Gateway errors: Those that apply to the whole request and are generated by the gateway layer.
    
-   Ecosystem API Service errors: Those that only apply only to a subset of the request and are generated by the service layer.

Important:

-   The two types of errors have different error response formats.
-   The response header contains a field called intuit_tid. Be sure to capture and save the value of this field as it will help to investigate the issue quickly when any issue occurs.

## Gateway Errors
```
Status code - Error details
302 - Resource redirect or resource has moved
401 - Unauthenticated access: application authentication failed due to invalid or expired tokens
403 - Forbidden access: authorization specific, application authorization failed due to insufficient user access role
403 - Resource not found: routing error, access or configuration on the  Gateway, or incorrect endpoint requested
405 - Method not allowed: attempt to request other than GET/POST requests
429 - Too many requests: request is throttled as it exceeded the throttle policy.
500 - Internal Server Error: missing POST body or other exceptions within application, or a service outage
502 - Bad Gateway: Infrastructure misconfiguration, propagates response from downstream, or a service outage
503 - Service unavailable: Outage
504 - Service timeout: Outage

```
The response format for all these above errors will follow the gateway error response format.

Here’s an example:
```
HTTP Status Code 401
{
  "code": "AuthenticationFailed",
  "type": "INPUT",
  "message": null,
  "detail": "Malformed bearer token: too short or too long",
  "moreInfo": null
}
```
The Intuit Gateway error response includes an error code and an error detail field, which contains more information about the error. Other fields in the response may or may not have values.

## Ecosystem Errors
Some types of service errors are malformed requests, GraphQL parsing errors, validation errors, system errors, and authorization errors related to incorrect scopes. The Ecosystem API service layer generates these errors, and the response format for such errors follows the GraphQL specification. The service layer returns both data and error in the response with an HTTP status code of either 200 or 400.

Note that the response for a successful request also has an HTTP status code 200, but the response will not contain any error messages.
```
Status code - Error details
200 - Authorization errors due to incorrect scope, or partial semantic errors
400 - GraphQL validation errors such as invalid or malformed requests and missing variables, or system errors
```
The response format for all these above errors will follow the GraphQL-compliant service error response format.
```
Here is an example where the HTTP status code is 400
{
  "errors": [
	{
  	"message": "Syntax error. Unable to parse incoming request",
  	"locations": [
    	{
      	"line": 4,
      	"column": 1
    	}
  	],
  	"extensions": {
    	"code": "VAL-0100",
    	"innerCode": "GRAPHQL_PARSE_FAILED",
    	"innerMessage": "Syntax Error: Expected Name, found }",
    	"classification": "VALIDATION_ERROR"
  	}
	}
  ]
}

Here are some examples where the HTTP status code is 200
{
  "errors": [
	{
  	"message": "Authorization error is detected for this request. Do you have sufficient scope?",
  	"extensions": {
    	"classification": "AUTHORIZATION",
    	"innerMessage": "Access denied; Insufficient Scope",
    	"code": "AHZ-0010"
  	}
	}
  ]
}

"errors": [
    {
      "message":  "VAL-0001 Failed to fetch name for account with id#1",
      "locations": [ { "line": 6, "column": 7 } ],
     "path": [ "company", "account", 1, "name" ]
    "extensions": {
        "classification": "VALIDATION_ERROR"
      }
    }
  ]

```
## Detailed Ecosystem Errors
As the examples above illustrate, you will need to handle the Ecosystem API Service error responses quite differently from the Intuit Gateway error responses listed in the previous section. Let’s dive deeper into the Ecosystem API Service error response.

Each service error response is an object with the following properties:

 1.   message — Description of the error.
 2.   locations — Describes where error happened in the GraphQL request.
 3.   path — Path to the field which caused the error. Could be only one. Here path has the following format : root object, node, line num, exact field name within the node
    
 4.   extensions — Additional information
 5. extensions.classification — Broad category this error belongs to.
    -   extensions.code — Service specific error code (for example API-0001). It represents a unique identifier for the error for easy
    understanding of the error. More on this below.
    -   extensions.innerCode — Internal unique identifier returned by downstream services (for example PAY-000008 - payroll). This may or
    may not be available always.
    -   extensions.innerMessage — Original internal message from downstream services. This may or may not be available always.

    
**An extensions.code is of the following format XXX-1234.**

The first 3 letters indicate the type of error.
|Code|Type|Description|
|--|--|--|
|Val|Validation Error|All syntactic (incorrect payload, format), semantic errors, missing data|
|AHZ|Authorization Error|All syntactic (incorrect payload, format), semantic errors, missing dataUser-level, app-level and system level authorization and insufficient scope|
|SYS|System Error|A known error produced by ecosystem components including authentication errors from downstream related to scopes|
|OTH|Other Error|All other unexpected errors|

The last 4 digits signify the source of the error from underlying services and other additional details.

If you get a service error, you can identify the issue and fix it by reading the message, location, path, extension.classification fields. If you are not able to fix the error or need more clarity, you can ask for help on our community forum or support [here](https://help.developer.intuit.com/s/) by providing the following:

-   Company ID/Realm ID
    
-   GraphQL request and response
    
-   intuit_tid header value from the response header
    
-   extensions.code
    
-   extensions.innerCode
    
-   extensions.innerMessage
    

This will help our teams investigate the issue and find more information on our end.


## Learn more 

- GraphQL official documentation: [https://graphql.org/](https://graphql.org/){:target="_blank"}
- Explore GraphQL: [https://www.graphql.com/](https://www.graphql.com/){:target="_blank"}
- Course: [https://www.edx.org/course/exploring-graphql-a-query-language-for-api](https://www.edx.org/course/exploring-graphql-a-query-language-for-api){:target="_blank"}
